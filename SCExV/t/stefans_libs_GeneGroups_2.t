#! /usr/bin/perl
use strict;
use warnings;
use Test::More tests => 5;
BEGIN { use_ok 'stefans_libs::GeneGroups' }

use FindBin;
my $plugin_path = "$FindBin::Bin";

my ( $value, @values, $exp, $tmp );
my $gg = stefans_libs::GeneGroups->new();
is_deeply( ref($gg), 'stefans_libs::GeneGroups',
	'simple test of function stefans_libs::GeneGroups -> new()' );


my $data = $gg->read_data( $plugin_path . '/data/problematic_2D_data.xls' );

unlink( $plugin_path . '/data/Output/problematic_MDS_2D.png' )
  if ( -f $plugin_path . '/data/Output/problematic_MDS_2D.png' );

is_deeply(
	[ @{ $data->{'header'} }[ 1, 2 ] ],
	[ 'PC1', 'PC2' ],
	'Gene Names as expected'
);

$exp = {
  '40.5754383339809' => '8.6911667450103',
  '31.9276042831058' => '-12.4823419914825',
  '32.9523104637918' => '-1.26488802025074',
  '37.5466341812439' => '-2.65124068009503',
  '-36.6234549019482' => '11.8369995164404',
  '-33.2848244475877' => '-8.67330029511204',
  '-34.8050966518862' => '-5.28861165065091',
  '-45.3185504203691' => '14.3161259998994',
  '17.355595465728' => '2.23591115229744',
  '36.3987245022145' => '-5.87589466529326',
  '-45.7380316767232' => '4.68754893292817',
  '32.9305451991334' => '-7.53746291962756',
  '-46.4478702307721' => '3.15574477212191',
  '-32.26587217397' => '-0.404590630087879',
  '-46.1266274237688' => '13.0692858476354',
  '-44.4312621148893' => '6.29472717190446',
  '-31.4980766322674' => '19.3451051272977',
  '42.6213165513526' => '-1.29759535093355',
  '-6.00129480102624' => '1.85222616934361',
  '42.5331272228828' => '-5.2552520230267',
  '28.6271188377372' => '9.49140668335557',
  '-35.3307936563729' => '8.52568013381519',
  '-44.7779205126188' => '9.53455274401434',
  '-22.1083589305399' => '-105.428411280296',
  '-38.5195241168601' => '11.3598291478458',
  '44.5183964871356' => '-0.674971961288167',
  '34.935568302787' => '3.80426929628031',
  '-38.0106646962973' => '10.751664186579',
  '39.5350842832597' => '4.55240991263682',
  '-3.90202452343171' => '7.22912264871016',
  '39.0964122310093' => '4.28451319835388',
  '38.2524011698328' => '-2.04175007861586',
  '31.6798217637154' => '-2.72843605119644',
  '-23.265965735293' => '-1.85068817547774',
  '40.5090170167428' => '11.3277476769684',
  '31.0090681479198' => '-5.15466019163467',
  '17.8475189403025' => '-0.409446517458761',
  '-43.2643839950083' => '12.8548599302445',
  '33.1433500095561' => '17.0215428931029',
  '37.2501550040635' => '7.88653840844826',
  '27.9072232283515' => '13.7075805271479',
  '36.3157850546395' => '13.9547170049298',
  '47.3629637795277' => '8.93119956889903',
  '41.7202867999055' => '7.3425835029391',
  '26.9778529436399' => '1.72333459810373',
  '-41.5589260885428' => '-12.3066974465961',
  '20.4150092177573' => '-11.1334511413174',
  '-48.0358751501746' => '-8.59389473471436',
  '33.6281955099336' => '1.17911459085524',
  '19.5559063517014' => '-47.5154796594541',
  '32.7280776195816' => '10.7577769688224',
  '-43.3762972651064' => '15.1941884339473',
  '-35.9029068479357' => '0.500685553249381',
  '-46.4224816482185' => '11.7011479931661',
  '3.89536803922297' => '23.8631175921153',
  '-41.0976669737452' => '-6.1016262537975',
  '42.1282308123244' => '-2.70047891229959',
  '-29.1712717156595' => '8.28705844876701',
  '39.9031437075224' => '14.6946677103617',
  '43.9039289936515' => '-0.651284577046672',
  '-50.0804067269535' => '-1.56983883886248',
  '37.5894173819909' => '6.32292026090095',
  '41.5221143247851' => '-4.7010131315971',
  '-27.8502679872986' => '16.3762978102273',
  '26.9452836306579' => '-3.83785096206566',
  '32.5281044013459' => '19.3757650844609',
  '-44.5415303232321' => '10.931864992504',
  '20.8189632449136' => '-10.8920956033406',
  '41.5023071519937' => '13.3328543837601',
  '35.3375716730053' => '-10.4645187106484',
  '-47.5999584677222' => '10.472245379478',
  '-27.3633658774181' => '12.6963949229443',
  '-46.7557764340071' => '2.96580538451584',
  '-22.6081071642879' => '-121.766117922408',
  '-5.79408578268592' => '9.78366806500386',
  '47.3473693957379' => '10.7847751030718',
  '-32.2558852393608' => '4.72545105608122',
  '36.4398745946167' => '9.20206138514336',
  '-36.4183350032567' => '1.17344879221749',
  '-43.6012273814332' => '10.7727658061249',
  '-38.8936223775454' => '-9.17334599945089',
  '-38.1515216889533' => '9.497599233377',
  '19.4233139908516' => '-23.1149713383508',
  '-49.2536597537741' => '-2.63884360114963',
  '31.6622638015782' => '-3.47671835204238',
  '-22.1757676347207' => '-3.58167642632024',
  '-38.9901448897553' => '14.878082962514',
  '-47.8159551627849' => '8.5680455558628',
  '25.6346022484481' => '0.381329432980309',
  '22.6812619063743' => '-6.55576911437593',
  '37.9526255295648' => '-1.13786786612379',
  '40.6854123675905' => '4.69762598243311',
  '-48.3646495144256' => '8.11843266502102',
  '7.80232227663478' => '-36.7278870969833',
  '-33.448389552249' => '7.69599477037387',
  '27.6033584405855' => '4.8959061749943',
  '-32.3483100282682' => '23.3823903372548',
  '-44.9588157208761' => '3.91317211798709',
  '-30.8897527845626' => '-12.2552980618805',
  '-44.5109977582927' => '12.2336294170386',
  '35.6955923813811' => '-1.18679781770959',
  '39.4660552795093' => '-4.81591245789461',
  '34.7226267955858' => '3.78965327753786',
  '35.9696333578104' => '-4.20775377745633',
  '-34.5485984176556' => '22.3073685159126',
  '-16.7471698473309' => '-82.3530736217613',
  '29.0442201055941' => '-38.0296192109412',
  '-38.3528849217412' => '5.27029505102103',
  '-40.5937390611654' => '13.2749062707312',
  '32.3693140618425' => '5.80017819991838',
  '-41.2695025408219' => '4.53516013224763',
  '-47.5038662477488' => '6.46781893990841',
  '-34.9866943087446' => '13.8806092462988',
  '-41.6506741005293' => '9.09179796307375',
  '35.2807816751347' => '-3.31368102899522',
  '-24.6659752195048' => '-11.0656427295073',
  '37.6383017361251' => '13.2787780982559',
  '37.5647704491477' => '13.0355615792654',
  '-29.3505617415741' => '-7.19553602450256',
  '30.3891377928635' => '9.50479958020979',
  '30.002757801411' => '2.15949244070953',
  '-46.0596321698986' => '-9.57739025458822',
  '16.7767602800018' => '9.01755678391035',
  '3.70954512023654' => '-26.7133713162632',
  '38.363847897737' => '11.6668619919454',
  '-29.4120651564434' => '-9.09052067196507',
  '-44.8928041273723' => '-13.257410258815',
  '33.9194636443049' => '12.9622568284329',
  '-27.7888059392749' => '-1.90267169546882',
  '-24.4725541330989' => '6.68086731840809',
  '39.7766386150781' => '3.76473812721324',
  '38.490336192782' => '-4.31805288741056',
  '36.5475857282762' => '8.07577243674154',
  '31.3495434370314' => '-10.6437334796254',
  '37.1010127000822' => '2.17935593958652',
  '36.6423488797791' => '15.1444719892611',
  '-39.1459115552851' => '0.825360935842518',
  '-24.3817518472661' => '3.78025601890718',
  '39.472741087669' => '-1.59182537118053',
  '32.104233945468' => '6.99577727274822',
  '-11.2582019545425' => '16.9967579483609',
  '32.2495029027909' => '-2.28613434061195',
  '-42.0116471427177' => '2.33319816323355',
  '19.3813742082947' => '-13.5077962591727',
  '38.3658661910529' => '13.6511759398759',
  '32.0071231447113' => '-8.75018006835041',
  '31.6982722937482' => '-9.44155476667289',
  '44.1325035339741' => '4.52431756768498',
  '25.9517570160346' => '4.6005289109178',
  '29.433494787081' => '-7.44443509089714',
  '-22.5346284981154' => '-119.906349854151',
  '-36.3029994055104' => '2.37547308239229',
  '24.3672614499366' => '17.4969376714562',
  '45.9442382594164' => '6.30145244806248',
  '24.5285097633096' => '2.27432750464443',
  '-50.1427933299023' => '13.3683692766065',
  '35.2089244760688' => '5.26970325442248',
  '29.0146563845497' => '-27.0478101683741',
  '39.0254004998121' => '8.20923291877878',
  '-29.6397419737447' => '13.2614013126552',
  '-19.3952414424764' => '2.92375931411573',
  '30.5604716480812' => '15.0290249261599',
  '40.4363041277514' => '15.6258174160882',
  '-33.1258732519579' => '9.03186843361888',
  '42.6534900513028' => '0.0637408571896647',
  '47.879935006477' => '9.03426734023699',
  '-30.436458750588' => '3.04157428427296',
  '-26.6011796846587' => '14.3760784569875',
  '-44.4137929913353' => '7.88530475900194',
  '-49.9791095667195' => '-16.7740450360646',
  '-40.3550922629925' => '1.5387514933927',
  '-30.7356411981571' => '4.95965236381596',
  '-29.7704453762126' => '-1.1512113556468',
  '-35.3895151025002' => '7.08251224287221',
  '-49.6541261052644' => '17.2002093450952',
  '-13.0028972441833' => '15.4893418616323',
  '-51.0226091374' => '3.10440865917993',
  '-46.7826355190417' => '9.9519938833295',
  '-10.7172696076393' => '-8.73581488555334',
  '21.5687516794206' => '15.7307650290678',
  '20.116418901976' => '4.5036847174453',
  '-43.7917675859265' => '10.5172946822861',
  '37.1557236395629' => '10.268438359646',
  '42.608607071785' => '11.1444034479226',
  '37.2898020714869' => '2.66440556652271',
  '24.1035629918811' => '-12.8115206748254',
  '-50.169775032783' => '3.260618381968',
  '39.507481202438' => '9.46189404387182',
  '-37.2085875721715' => '1.27903023485925',
  '37.774509941877' => '7.14586834551213',
  '-34.3777807751508' => '-5.27992839606032',
  '44.5565873164041' => '14.0323353966297',
  '37.6339041941197' => '11.0908779232815',
  '-40.6241883040301' => '9.92838889410791',
  '37.3541646410368' => '-4.44428889714888',
  '-30.2248073477911' => '-8.77567236173039',
  '44.6042259592594' => '-10.1370809910866',
  '19.0764429431531' => '21.1727690581984',
  '-33.4104308964086' => '3.48756305363843',
  '-49.4039462459781' => '9.74113374473684',
  '8.24433502932596' => '-14.2249156495167',
  '45.5144907049568' => '-19.1114296767856',
  '39.3335698487157' => '15.5242005650436',
  '-45.7486063928168' => '17.9170509007684',
  '-39.9419679729904' => '10.5986576283531',
  '31.1462516270506' => '13.54970758656',
  '33.0965453868508' => '-36.4022863592517',
  '40.2476119781758' => '1.63128236275996',
  '-29.2468862678803' => '6.25087280332683',
  '42.7944958686362' => '-1.49385281578947',
  '-39.4688180951712' => '6.19345931631956',
  '45.448403696459' => '-3.51400925469635',
  '-42.6467218750633' => '13.846525847913',
  '-14.627865770951' => '-34.5891021078967',
  '8.40005656634826' => '20.045997990005',
  '34.3681377778506' => '-13.0552103104159',
  '-22.1735096677785' => '-119.744449621852',
  '-36.8768981686107' => '-1.7763341245708',
  '-54.3034512990183' => '3.51800628978147',
  '-48.5136568063229' => '2.87852459734258',
  '-36.7399419073183' => '2.93193592297531',
  '-43.0335773987913' => '13.1981883745445',
  '37.2191274896956' => '-4.0352637023865',
  '20.9678675793546' => '-0.0443481413360387',
  '40.1497895845595' => '-7.71577771918107',
  '-42.128568406324' => '6.58295479405542',
  '-42.3573790762857' => '8.60205869987156',
  '-1.82781064369838' => '15.7642995474038',
  '-45.8000245850651' => '17.5756511772688',
  '-25.5387102813408' => '-2.82345226171685',
  '37.7351495257531' => '3.15159241437405',
  '-20.3095326182008' => '4.0405891122941',
  '-34.3086564720926' => '9.57890784657311',
  '-31.061615564601' => '-7.11905602856326',
  '17.0443616259401' => '9.74929428484133',
  '-27.80365284675' => '20.5987931328047',
  '-32.3219128621002' => '11.568285340297',
  '-41.0601713809059' => '15.6311217280878',
  '-47.1460284674478' => '8.24594973530997',
  '-27.5960095547581' => '-3.93845990093297',
  '-46.9181964526907' => '7.12358576794249',
  '39.9651575005494' => '8.89631428224895',
  '-17.344844429967' => '-115.959244188152',
  '-41.162566716405' => '3.72422179665397',
  '-49.0956573503046' => '11.4634545985904',
  '35.5688124166584' => '2.58939808382397',
  '37.101261462365' => '13.4646704843265',
  '19.4387518145246' => '-30.9652376830576',
  '39.1655114283759' => '8.8863873055262',
  '29.3172835331858' => '-1.28678722403567',
  '-33.6208893937166' => '-12.7820442199468',
  '-28.310967335854' => '3.93286051973498',
  '32.8757634383587' => '6.44947102065682',
  '24.4661613511322' => '-0.0273281084744834',
  '-29.0759507927558' => '11.1661093369355',
  '-50.5897356054378' => '4.43974552121699',
  '38.6518963979774' => '-14.1297986375414',
  '16.291678008015' => '16.4717525017306',
  '-44.0629546208035' => '4.99562002066809',
  '19.546151878914' => '13.6982620159523',
  '-42.3088545260624' => '10.6878743976238',
  '-28.8323515738946' => '-20.4641717559029',
  '36.4884321829356' => '3.51315111693996',
  '31.3164625108872' => '10.6271278528167',
  '-34.239725613883' => '10.1454458183694',
  '31.6274710010617' => '2.88720651542566',
  '39.9032901121396' => '17.4378131798858',
  '33.3141533020151' => '-0.184602083970779',
  '30.0595134103946' => '-6.13575028571396',
  '34.0374025782938' => '-10.0499421177454',
  '12.2251676067559' => '-41.9243910976151',
  '35.1506764516757' => '-6.17521068254848',
  '41.0728154533782' => '7.34423097296154',
  '31.2709062111635' => '15.8064807653642',
  '25.630049049833' => '-2.48672746991075',
  '37.3964666048841' => '13.5340390792637',
  '38.8007463681734' => '2.69819881673202',
  '-48.285633567804' => '5.77241291420703',
  '-47.3714081629411' => '5.55953383586017',
  '-39.9429663679422' => '4.04168736533688',
  '33.1258873729649' => '-11.7057322758569',
  '30.1441501217317' => '-15.9984775212512',
  '42.8213140432745' => '2.0315003697634',
  '36.0747540635969' => '13.7623197850309',
  '-20.6051441855037' => '-118.138613799631',
  '-49.0173648323345' => '0.878014133122194',
  '50.9899821913623' => '-3.77086338607187',
  '-41.668011099008' => '5.1981307038454'
};

is_deeply( $data->GetAsHash( 'PC1', 'PC2' ), $exp, "Read the correct information" );

#print "\$exp = ".root->print_perl_var_def( $data->GetAsHash( 'PC1', 'PC2' ) ) . ";\n";

unlink ( $plugin_path . '/data/Output/problematic_MDS_2D.png' ) if ( -f  $plugin_path . '/data/Output/problematic_MDS_2D.png');
$data->plotXY_fixed_Colors(
	$plugin_path . '/data/Output/problematic_MDS_2D.png',
	@{ $data->{'header'} }[ 1, 2 ],
	$data->new(
		{ 'filename' => $plugin_path . '/data/problematic_2D_data_color.xls' }
	)
);

ok ( -f $plugin_path . '/data/Output/problematic_MDS_2D.png', "Fixed color plot" );
#print "\$exp = ".root->print_perl_var_def(\@values ).";\n";

